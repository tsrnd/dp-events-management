swagger: '2.0'
info:
  version: 0.0.1
  title: Events Management API
consumes:
  - multipart/form-data
produces:
  - application/json
schemes:
  - http
  - https
securityDefinitions:
 Bearer:
  description: |
   For accessing the API a valid JWT token must be passed in all the queries in
   the 'Authorization' header.
   A valid JWT token is generated by the API and retourned as answer of a call
   to the route /login giving a valid user & password.
   The following syntax must be used in the 'Authorization' header :
   Bearer: xxxxxx.yyyyyyy.zzzzzz
  type: apiKey
  name: Authorization
  in: header
definitions:
  ErrorDetails:
      title: Error details
      type: object
      properties:
        message:
          type: string
          description: error messages
        errors:
          type: array
          items:
            description: error detail
            type: string
parameters:
  Title:
    name: title
    description: title event
    in: formData
    type: string
    required: true
  Start_datetime:
    name: start_datetime
    description: start time event
    in: formData
    required: true
    type: string
  End_datetime:
    name: end_datetime
    description: end time event
    in: formData
    required: true
    type: string
  Location:
    name: location
    description: Event location
    in: formData
    required: true
    type: string
  Time_notication:
    name: time_notication
    description: Time notication
    in: formData
    required: true
    type: string
  Owner:
    name: owner
    description: User create event
    in: formData
    required: True
    type: integer
  Event_content:
    name: event_content
    description: Event Content
    in: formData
    required: true
    type: string
  File_attack:
    name: file_attack
    description: File attack
    in: formData
    required: false
    type: string
  Guest_can_invite:
    name: guest_can_invite
    description: Guest can invite
    in: formData
    required: true
    type: boolean
  View_all_guest:
    name: view_all_guest
    description: View all guest
    in: formData
    required: true
    type: boolean
  Item_preparing:
    name: item_preparing
    description: Item preparing
    in: formData
    required: false
    type: string
  Time_create:
    name: time_create
    description: Time create
    in: formData
    required: true
    type: string
  Last_edit:
    name: last_edit
    description: Time last edit
    in: formData
    required: false
    type: string
  User_edit:
    name: user_edit
    description: user edit
    in: formData
    required: false
    type: integer
  Status:
    name: status
    description: status event
    in: formData
    required: true
    type: integer
paths:
  /api/events:
    get:
      security:
       - Bearer: []
      summary: Return list events.
      tags:
       - Event
      description: |  
           returns list of information about "event".
      parameters:
        - name: result_limit
          in: query
          description:  |  
           Limit count of response record of searching.  
           if not setted,response record limit is 10.  
           minimun value =1,maximun value =100
          required: false
          type: integer
        - name: page
          in: query
          description:  |
           specify the number of page.
           if not seted,the number of page is 1.
          required: false
          type: integer
        - name: is_public
          in: query
          description: is event public
          required: false
          type: boolean
        - name: owner
          in: query
          description: is owner
          required: false
          type: integer
        - name: status
          in: query
          description: status event
          required: false
          type: integer
        - name: start_date
          in: query
          description: start date event
          required: false
          type: string
        - name: end_date
          in: query
          description: end date event
          required: false
          type: string
        
      responses:
        '200':
          description: Successful response
          schema:
            title: Successful response
            type: object
            properties:
              result_count:
               type: integer
               description:
                Count of result in this response
              event_list:
                type: array
                description: events sorted by DESC
                items:
                    type: object
                    properties:
                      title:
                        type: string
                        description: title of event(except for "#")
                        example: abc
                      start_datetime:
                        type: string
                        description: start time event
                        example: "2006-10-25 00:00:00+00"
                      end_datetime:
                        type: string
                        description: end time event
                        example: "2006-10-29 00:00:00+00"
                      location:
                        type: string
                        description: Event location
                        example: "10 Bạch Đằng, Đà Nẵng"
                      time_notication:
                        type: string
                        description: Time notication
                        example: "2006-10-26 00:00:00+00"
                      owner:
                        type: integer
                        description: User create event
                        example: 1
                      event_content:
                        type: string
                        description: Event Content
                        example: "meeting team"
                      file_attack:
                        type: string
                        description: File attack
                        example: "abc.pdf"
                      guest_can_invite:
                        type: boolean
                        description: Guest can invite
                        example: true
                      view_all_guest:
                        type: boolean
                        description: View all guest
                        example: false
                      item_preparing:
                        type: string
                        description: Item preparing
                        example: "money"
                      status:
                        type: integer
                        description: status event
                        example: 1
                      time_create:
                        type: string
                        description: Time create
                        example: "2006-10-29 00:00:00+00"
                      last_edit:
                        type: string
                        description: Time create
                        example: "00:00:00+00"
                      user_edit:
                        type: integer
                        description: user edit event
                        example: 1
        '400':
          description: Bad request error response
          schema:
            $ref: '#/definitions/ErrorDetails'
        '500':
          description: Internal server error response
          schema:
            $ref: '#/definitions/ErrorDetails'
  /api/event/{id_event}:
    get:
      security:
       - Bearer: []
      summary: Return detail a event.
      tags:
       - Event
      description: returns detail of a event.
      parameters:
        - name: id_event
          in: path
          description: id of event
          required: true
          type: integer
      responses:
        '200':
          description: Successful response
          schema:
            title: Successful response
            type: object
            properties:
              title:
                type: string
                description: title of event(except for "#")
                example: abc
              start_datetime:
                type: string
                description: start time event
                example: "2006-10-25 00:00:00+00"
              end_datetime:
                type: string
                description: end time event
                example: "2006-10-29 00:00:00+00"
              location:
                type: string
                description: Event location
                example: "10 Bạch Đằng, Đà Nẵng"
              time_notication:
                type: string
                description: Time notication
                example: "2006-10-26 00:00:00+00"
              owner:
                type: integer
                description: User create event
                example: 1
              event_content:
                type: string
                description: Event Content
                example: "meeting team"
              file_attack:
                type: string
                description: File attack
                example: "abc.pdf"
              guest_can_invite:
                type: boolean
                description: Guest can invite
                example: true
              view_all_guest:
                type: boolean
                description: View all guest
                example: false
              item_preparing:
                type: string
                description: Item preparing
                example: "money"
              status:
                type: integer
                description: status event
                example: 1
              time_create:
                type: string
                description: Time create
                example: "2006-10-29 00:00:00+00"
              last_edit:
                type: string
                description: Time create
                example: "00:00:00+00"
              user_edit:
                type: integer
                description: user edit event
                example: 1
                      
        '400':
          description: Bad request error response
          schema:
            $ref: '#/definitions/ErrorDetails'
        '500':
          description: Internal server error response
          schema:
            $ref: '#/definitions/ErrorDetails'
    put:
      summary: update event detail information
      tags:
       - Event
      description: |
        "First": 
          * if owner = "self" go to “Finally”
          * if owner != "self" return 403 error
          
        "Finally": return result 
      parameters:
        - name: id_event
          description: id of event
          in: path
          required: true
          type: integer
        - $ref: '#/parameters/Title'
        - $ref: '#/parameters/Start_datetime'
        - $ref: '#/parameters/End_datetime'
        - $ref: '#/parameters/Location'
        - $ref: '#/parameters/Time_notication'
        - $ref: '#/parameters/Owner'
        - $ref: '#/parameters/Event_content'
        - $ref: '#/parameters/File_attack'
        - $ref: '#/parameters/Guest_can_invite'
        - $ref: '#/parameters/View_all_guest'
        - $ref: '#/parameters/Item_preparing'
        - $ref: '#/parameters/Time_create'
        - $ref: '#/parameters/Last_edit'
        - $ref: '#/parameters/User_edit'
        - $ref: '#/parameters/Status'
      responses:
        '200':
          description: Successful response
        '400':
          description: Bad request error response
          schema:
            $ref: '#/definitions/ErrorDetails'
        '404':
          description: Not Found
          schema:
            $ref: '#/definitions/ErrorDetails'
        '403':
          description: Forbiden
          schema:
            $ref: '#/definitions/ErrorDetails'
        '500':
          description: Internal server error response
          schema:
            $ref: '#/definitions/ErrorDetails'
    delete:
      summary: Delete event
      tags:
        - Event
      description: |
        "First": 
          * if owner = "self" go to “Finally”
          * if owner != "self" return 403 error
          
        "Finally": return result 
      parameters:
        - name: id_event
          in: path
          required: true
          type: integer
      responses:
        '200':
          description: Successful response
        '400':
          description: Bad request error response
          schema:
            $ref: '#/definitions/ErrorDetails'
        '404':
          description: Not Found
          schema:
            $ref: '#/definitions/ErrorDetails'
        '403':
          description: Forbiden
          schema:
            $ref: '#/definitions/ErrorDetails'
        '500':
          description: Internal server error response
          schema:
            $ref: '#/definitions/ErrorDetails'
  /api/event:
    post:
      security:
       - Bearer: []
      summary: create event
      tags:
       - Events
      description: Create event
      parameters:
        - $ref: '#/parameters/Title'
        - $ref: '#/parameters/Start_datetime'
        - $ref: '#/parameters/End_datetime'
        - $ref: '#/parameters/Location'
        - $ref: '#/parameters/Time_notication'
        - $ref: '#/parameters/Owner'
        - $ref: '#/parameters/Event_content'
        - $ref: '#/parameters/File_attack'
        - $ref: '#/parameters/Guest_can_invite'
        - $ref: '#/parameters/View_all_guest'
        - $ref: '#/parameters/Item_preparing'
        - $ref: '#/parameters/Time_create'
        - $ref: '#/parameters/Last_edit'
        - $ref: '#/parameters/User_edit'
        - $ref: '#/parameters/Status'
      responses:
        '200':
          description: Successful response
        '400':
          description: Bad request error response
          schema:
            $ref: '#/definitions/ErrorDetails'
        '500':
          description: Internal server error response
          schema:
            $ref: '#/definitions/ErrorDetails'
  /api/users/:
    get:
      summary: Return list users.
      tags:
       - User
      description: returns list of information about "users". filtering if parameter setted
      parameters:
        - name: result_limit
          in: query
          description:  Limit count of response record of searching. if not setted,response record limit is 10. minimun value =1,maximun value =100
          required: false
          type: integer
        - name: key_word
          in: query
          description: parameter key word to search user
          required: false
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            title: Successful response
            type: object
            properties:
              result_count:
               type: integer
               description:
                Count of result in this response
              user_list:
                type: array
                description: users sorted by DESC
                items:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: id of user
                        example: 1
                      username:
                        type: string
                        description: username of user
                        example: "user1"
                      first_name:
                        type: string
                        description: first name of user
                        example: "Nghia"
                      last_name:
                        type: string
                        description: last name of user
                        example: "Vo"
                      email:
                        type: string
                        description: email of user
                        example: "nghia.vo@asiantech.vn"
        '400':
          description: Bad request error response
          schema:
            $ref: '#/definitions/ErrorDetails'
        '500':
          description: Internal server error response
          schema:
            $ref: '#/definitions/ErrorDetails'
  /api/invite/event/{id_event}:
    post:
      summary: create invitation to join event
      tags:
       - Invitation
      description: Create invite event
      parameters:
        - name: id_event
          description: id of event
          in: path
          required: true
          type: integer
        - name: user_id
          description: id of user
          in: formData
          required: true
          type: integer
      responses:
        '200':
          description: Successful response
        '400':
          description: Bad request error response
          schema:
            $ref: '#/definitions/ErrorDetails'
        '404':
          description: Not Found
          schema:
            $ref: '#/definitions/ErrorDetails'
        '500':
          description: Internal server error response
          schema:
            $ref: '#/definitions/ErrorDetails' 
    delete:
      summary: Delete invited user to the event
      tags:
       - Invitation
      description: Delete invited user to the event
      parameters:
        - name: id_event
          description: id of event
          in: path
          required: true
          type: integer
        - name: user_id
          description: id of user
          in: formData
          required: true
          type: integer
      responses:
        '200':
          description: Successful response
        '400':
          description: Bad request error response
          schema:
            $ref: '#/definitions/ErrorDetails'
        '404':
          description: Not Found
          schema:
            $ref: '#/definitions/ErrorDetails'
        '500':
          description: Internal server error response
          schema:
            $ref: '#/definitions/ErrorDetails' 
  